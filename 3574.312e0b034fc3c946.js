"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[3574],{1762:(O,E,i)=>{i.d(E,{B:()=>L});var e=i(5e3),_=i(4996),p=i(9808);const v=function(d){return{active:d}};function B(d,f){if(1&d){const c=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(){const P=e.CHM(c).$implicit;return e.oxw().scroll(P)}),e._uU(1),e.qZA()}if(2&d){const c=f.$implicit,h=e.oxw();e.Q6J("ngClass",e.VKq(2,v,h.activeClass===c.id)),e.xp6(1),e.Oqu(c.title)}}function m(d,f){if(1&d){const c=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){return e.CHM(c),e.oxw().handleSaveBtnClicked()}),e._UZ(1,"img",9),e.qZA()}if(2&d){const c=e.oxw();e.Q6J("disabled",c.disableSaveBtn)}}function t(d,f){if(1&d){const c=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){return e.CHM(c),e.oxw().handleAddCancelClicked()}),e._UZ(1,"img",11),e.qZA()}}function l(d,f){if(1&d){const c=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){return e.CHM(c),e.oxw().handleSaveCancelClicked()}),e._UZ(1,"img",12),e.qZA()}}function g(d,f){1&d&&(e.TgZ(0,"button",13),e._UZ(1,"img",14),e.qZA())}function C(d,f){if(1&d){const c=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(c);const A=e.oxw();return A.editButtonURL(null==A.editButton?null:A.editButton.url)}),e._UZ(1,"img",15),e.qZA()}}let L=(()=>{class d{constructor(c){this.router=c,this.activeClass="init",this.mode="menu",this.saveBtn=!1,this.disableSaveBtn=!1,this.cancelBtn=!1,this.disableCancelBtn=!1,this.addBtn=!1,this.disableAddBtn=!1,this.onCancel=new e.vpe,this.onSave=new e.vpe,this.onAdd=new e.vpe,this.menuItems=[]}ngOnInit(){}ngAfterContentInit(){this.activeClass=0!=this.menuItems.length?this.menuItems[0].id:""}scroll(c){const h=document.getElementById(c.id);h&&h.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}handleSaveBtnClicked(){this.onSave.emit()}handleSaveCancelClicked(){this.onCancel.emit()}handleAddCancelClicked(){this.onAdd.emit()}editButtonURL(c){this.router.navigate([c])}}return d.\u0275fac=function(c){return new(c||d)(e.Y36(_.F0))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-nav-bar-pills"]],inputs:{activeClass:"activeClass",mode:"mode",saveBtn:"saveBtn",disableSaveBtn:"disableSaveBtn",cancelBtn:"cancelBtn",disableCancelBtn:"disableCancelBtn",addBtn:"addBtn",editButton:"editButton",disableAddBtn:"disableAddBtn",menuItems:"menuItems"},outputs:{onCancel:"onCancel",onSave:"onSave",onAdd:"onAdd"},decls:10,vars:6,consts:[["id","navbar-pills"],[1,"left",2,"margin-left","0px"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"right"],["class","save",3,"disabled","click",4,"ngIf"],["class","cancel",3,"click",4,"ngIf"],["class","save",4,"ngIf"],[3,"ngClass","click"],[1,"save",3,"disabled","click"],["src","/assets/icons/save.svg","alt",""],[1,"cancel",3,"click"],["src","/assets/icons/add.svg","alt",""],["src","/assets/icons/cancel.svg","alt",""],[1,"save"],["src","/assets/icons/Add-Patient-Wizard-Green.svg","alt",""],["src","/assets/icons/Add-Patient-Wizard-Red.svg","alt",""]],template:function(c,h){1&c&&(e.TgZ(0,"div")(1,"div",0)(2,"div",1),e.YNc(3,B,2,4,"a",2),e.qZA(),e.TgZ(4,"div",3),e.YNc(5,m,2,1,"button",4),e.YNc(6,t,2,0,"button",5),e.YNc(7,l,2,0,"button",5),e.YNc(8,g,2,0,"button",6),e.YNc(9,C,2,0,"button",5),e.qZA()()()),2&c&&(e.xp6(3),e.Q6J("ngForOf",h.menuItems),e.xp6(2),e.Q6J("ngIf",h.saveBtn),e.xp6(1),e.Q6J("ngIf",h.addBtn),e.xp6(1),e.Q6J("ngIf",h.cancelBtn),e.xp6(1),e.Q6J("ngIf",h.disableSaveBtn&&(null==h.editButton?null:h.editButton.isButton)),e.xp6(1),e.Q6J("ngIf",!h.disableSaveBtn&&(null==h.editButton?null:h.editButton.isButton)))},directives:[p.sg,p.mk,p.O5],styles:["#navbar-pills[_ngcontent-%COMP%]{height:40px;display:grid;grid-template-columns:1fr auto;margin-bottom:10px}#navbar-pills[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{background:#f9f9f9;display:flex;gap:15px;align-items:center;padding-left:10px;border-radius:6px;white-space:nowrap;overflow-y:auto}#navbar-pills[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:0 15px;text-decoration:none;color:#000;line-height:2.6;border-bottom:2px solid transparent}#navbar-pills[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{cursor:pointer;border-bottom:2px solid var(--primary);color:var(--primary)!important}#navbar-pills[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{color:var(--primary)!important;border-bottom:2px solid var(--primary);font-weight:400}#navbar-pills[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{background:transparent;display:flex;gap:5px}#navbar-pills[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background:transparent;width:34px}#navbar-pills[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5}#navbar-pills[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:38px}"]}),d})()},8076:(O,E,i)=>{i.d(E,{F:()=>p});var e=i(9808),_=i(5e3);let p=(()=>{class v{}return v.\u0275fac=function(m){return new(m||v)},v.\u0275mod=_.oAB({type:v}),v.\u0275inj=_.cJS({imports:[[e.ez]]}),v})()},3574:(O,E,i)=>{i.r(E),i.d(E,{AssignRoleModule:()=>k});var e=i(9808),_=i(4376),p=i(2382),v=i(8076),B=i(4996),m=i(531),t=i(5e3),l=i(9709),g=i(1228),C=i(5730),L=i(4001),d=i(7802),f=i(1762);function c(r,b){if(1&r){const s=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"span",16),t.NdJ("click",function(){const n=t.CHM(s),u=n.$implicit,a=n.index;return t.oxw(2).cancleUserCurrentRole(u,a)}),t._UZ(3,"i",17),t.qZA(),t._UZ(4,"input",18),t.qZA()()}if(2&r){const s=b.$implicit;t.xp6(4),t.s9C("value",s.name)}}function h(r,b){if(1&r&&(t.TgZ(0,"div",12),t.YNc(1,c,5,1,"div",13),t.qZA()),2&r){const s=t.oxw();t.xp6(1),t.Q6J("ngForOf",s.userCurrentRoleList)}}function A(r,b){if(1&r&&(t.TgZ(0,"ng-option",19),t._uU(1),t.qZA()),2&r){const s=b.$implicit;t.Q6J("value",s),t.xp6(1),t.hij(" ",null==s?null:s.name," ")}}const D=[{path:"",component:(()=>{class r{constructor(s,o,n,u,a,T,I){this.router=s,this.fb=o,this.userService=n,this.authService=u,this.alertService=a,this.roleService=T,this.businessGroupDropdownService=I,this.formData=void 0,this.userCurrentRoleList=[],this.roleList=[],this.userAssignRoleIdsList=[],this.roleRRT=!1,this.roleRRTEdit=!1,this.roleRRTAdd=!1,this.roleRRTDelete=!1,this.roleURRT=!1,this.roleURRTEdit=!1,this.roleURRTAdd=!1,this.roleURRTDelete=!1,this.businessGroupDropdownSupscription=this.businessGroupDropdownService.businessGroup().subscribe(S=>{S&&(this.selectedBusinessGroup=S,this.userCurrentRoleList=[],this.getOrgBgId())})}ngOnInit(){this.initForm(this.formData)}initForm(s){s=s||{},this.Form=this.fb.group({})}save(){let s={roles:this.userAssignRoleIdsList},o=localStorage.getItem("userId");this.alertService.conformAlert("Are you sure?","You want to update user role").then(n=>{n.value&&this.userService.updateUserRole(this.logInType,o,s).subscribe({next:u=>{u&&this.alertService.success("Success","User role has been updated successfully")},error:()=>{}})})}cancel(){this.alertService.conformAlert("Are you sure?","You want to edit").then(s=>{s.value&&this.router.navigate(["/dashboard/settings/user-management/manage-user"])})}getOrgBgId(){var s,o,n,u,a,T,I;let S=localStorage.getItem("selected_business_group"),R=localStorage.getItem("permissionSet");R=JSON.parse(R),console.log(R),(null==R?void 0:R.__ISSU__)?"intelliveer"==S||null==S?(this.getUserCurrentRoleList("intelliveer"),this.getRolesList("intelliveer"),this.logInType="intelliveer"):(this.getUserCurrentRoleList(null===(s=this.selectedBusinessGroup)||void 0===s?void 0:s.bgId),this.getRolesList(null===(o=this.selectedBusinessGroup)||void 0===o?void 0:o.bgId),this.logInType=null===(n=this.selectedBusinessGroup)||void 0===n?void 0:n.bgId):(null==R?void 0:R.isBGAdmin)?(this.getRoleListByBgAdminId(null===(u=null==R?void 0:R.bgs[0])||void 0===u?void 0:u._id),this.logInType=null===(a=this.selectedBusinessGroup)||void 0===a?void 0:a.bgId):(this.getRoleListByBgId(null===(T=this.selectedBusinessGroup)||void 0===T?void 0:T.bgId),this.logInType=null===(I=this.selectedBusinessGroup)||void 0===I?void 0:I.bgId)}getUserCurrentRoleList(s){this.userCurrentRoleList=[],this.userAssignRoleIdsList=[];let o=localStorage.getItem("userId");this.userService.getUserData(s,o).subscribe(n=>{if(n)for(let u=0;u<n.roles.length;u++)this.userService.getUserRoleData(s,n.roles[u]).subscribe({next:a=>{a&&(this.userCurrentRoleList.push({_id:a._id,name:a.name}),this.userCurrentRoleList=this.getUniqueListBy(this.userCurrentRoleList,"name"),this.userAssignRoleIdsList.push(a._id),this.roleList=this.getRoleFilterLst(this.tempRoleList,this.userCurrentRoleList))},error:()=>{}})},n=>{console.log(n)})}getUniqueListBy(s,o){return[...new Map(s.map(n=>[n[o],n])).values()]}cancleUserCurrentRole(s,o){1!=this.userCurrentRoleList.length?this.alertService.conformAlert("Are you sure?","You want to delete role").then(n=>{if(n.value){this.userCurrentRoleList.splice(o,1),this.userAssignRoleIdsList.splice(o,1);let u={roles:this.userAssignRoleIdsList},a=localStorage.getItem("userId");this.userService.updateUserRole(this.logInType,a,u).subscribe({next:T=>{T&&(this.alertService.success("Success","User role has been updated successfully"),this.roleList=this.getRoleFilterLst(this.tempRoleList,this.userCurrentRoleList))},error:()=>{}})}}):this.alertService.displayAlertMessage("Sorry....","You can not delete role")}getRolesList(s){var o=this;return(0,m.Z)(function*(){yield o.userService.getRoleList(s).subscribe({next:n=>{o.tempRoleList=n},error:()=>{}})})()}getRoleListByBgId(s){this.checkPermissionRRTOrURRT(),console.log(s),this.roleService.getRoleListByID(s).subscribe(o=>{console.log("list",o),this.roleRRT&&!this.roleURRT?this.tempRoleList=o:this.roleRRT&&this.roleURRT?this.roleService.getRoleListByIDUnRestricted(s).subscribe(n=>{this.tempRoleList=[...o,...n]}):!this.roleRRT&&this.roleURRT&&this.roleService.getRoleListByIDUnRestricted(s).subscribe(n=>{this.tempRoleList=n}),this.getUserCurrentRoleList(s)})}getRoleListByBgAdminId(s){console.log(s),this.roleService.getRoleListByID(s).subscribe(o=>{this.roleService.getRoleListByIDUnRestricted(s).subscribe(n=>{this.tempRoleList=[...o,...n],console.log(this.tempRoleList)}),this.getUserCurrentRoleList(s)})}getRoleFilterLst(s,o){return null==s?void 0:s.filter(n=>!o.some(u=>n._id===u._id))}selectRoleData(s){let o={id:s._id,name:s.name};this.userAssignRoleIdsList.push(s._id);let n={roles:this.userAssignRoleIdsList},u=localStorage.getItem("userId");this.userService.updateUserRole(this.logInType,u,n).subscribe({next:a=>{a&&(this.userCurrentRoleList.push(o),this.roleList=this.getRoleFilterLst(this.tempRoleList,this.userCurrentRoleList),this.alertService.success("Success","User role has been updated successfully"))},error:()=>{}})}checkPermissionRRTOrURRT(){var s,o;let n=localStorage.getItem("permissionSet");n=JSON.parse(n),console.log(n.roles[0]),null===(o=null===(s=null==n?void 0:n.roles[0])||void 0===s?void 0:s.permissions[0])||void 0===o||o.sections.forEach(u=>{console.log(u),"templateBasedRestrictedRoles"==u.section?u.permissions.forEach(a=>{switch(a.name){case"CAN_CREATE_TEMPLATE_BASED_RESTRICTED_ROLE":this.roleURRTAdd=a.enabled;break;case"CAN_RETRIEVE_TEMPLATE_BASED_RESTRICTED_ROLE":this.roleURRT=a.enabled;break;case"CAN_EDIT_TEMPLATE_BASED_RESTRICTED_ROLE":this.roleURRTEdit=a.enabled;break;case"CAN_DELETE_TEMPLATE_BASED_RESTRICTED_ROLE":this.roleURRTDelete=a.enabled}}):"templateBasedUnRestrictedRoles"==u.section&&u.permissions.forEach(a=>{switch(a.name){case"CAN_CREATE_TEMPLATE_BASED_UNRESTRICTED_ROLE":this.roleRRTAdd=a.enabled;break;case"CAN_RETRIEVE_TEMPLATE_BASED_UNRESTRICTED_ROLE":this.roleRRT=a.enabled;break;case"CAN_EDIT_TEMPLATE_BASED_UNRESTRICTED_ROLE":this.roleRRTEdit=a.enabled;break;case"CAN_DELETE_TEMPLATE_BASED_UNRESTRICTED_ROLE":this.roleRRTDelete=a.enabled}}),console.log(this.roleRRT,this.roleRRTAdd,this.roleRRTDelete,this.roleRRTEdit)})}}return r.\u0275fac=function(s){return new(s||r)(t.Y36(B.F0),t.Y36(p.qu),t.Y36(l.K),t.Y36(g.e),t.Y36(C.c),t.Y36(L.N),t.Y36(d.Y))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-assign-role"]],decls:15,vars:6,consts:[[3,"cancelBtn","saveBtn","disableSaveBtn","onCancel","onSave"],["id","main",1,"section"],[1,"heading",2,"font-weight","bold"],[1,"label-input-gap",2,"font-weight","bold"],["class","row mb-3","style","padding: 5px",4,"ngIf"],["autocomplete","off",3,"formGroup","submit"],["f","ngForm"],[1,"row",2,"margin-bottom","48px !important"],[1,"col-3"],[1,"label-input-gap"],["placeholder","Select Role",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"row","mb-3",2,"padding","5px"],["class","col-3 p-2",4,"ngFor","ngForOf"],[1,"col-3","p-2"],[1,"input-group","flex-nowrap"],[1,"input-group-text",2,"background-color","#faf2e9","border","1px solid #f9b85f",3,"click"],[1,"bi","bi-x-lg"],["type","text","readonly","",1,"form-control",2,"border-color","#f9b85f","background-color","#faf2e9","width","max-content",3,"value"],[3,"value"]],template:function(s,o){1&s&&(t.TgZ(0,"app-nav-bar-pills",0),t.NdJ("onCancel",function(){return o.cancel()})("onSave",function(){return o.save()}),t.qZA(),t.TgZ(1,"div",1)(2,"h6",2),t._uU(3,"Role Assignment"),t.qZA(),t.TgZ(4,"label",3),t._uU(5,"Current Roles"),t.qZA(),t.YNc(6,h,2,1,"div",4),t.TgZ(7,"form",5,6),t.NdJ("submit",function(){return o.save()}),t.TgZ(9,"div",7)(10,"div",8)(11,"label",9),t._uU(12,"Roles"),t.qZA(),t.TgZ(13,"ng-select",10),t.NdJ("change",function(u){return o.selectRoleData(u)}),t.YNc(14,A,2,2,"ng-option",11),t.qZA()()()()()),2&s&&(t.Q6J("cancelBtn",!0)("saveBtn",!0)("disableSaveBtn",o.Form.invalid),t.xp6(6),t.Q6J("ngIf",0!=(null==o.userCurrentRoleList?null:o.userCurrentRoleList.length)),t.xp6(1),t.Q6J("formGroup",o.Form),t.xp6(7),t.Q6J("ngForOf",o.roleList))},directives:[f.B,e.O5,e.sg,p._Y,p.JL,p.sg,_.w9,_.jq],styles:["#main[_ngcontent-%COMP%]{height:calc(100vh - 310px);overflow:auto;padding-bottom:5rem}"]}),r})()}];let M=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[B.Bz.forChild(D)],B.Bz]}),r})(),k=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[e.ez,M,_.A0,p.u5,p.UX,v.F]]}),r})()},4001:(O,E,i)=>{i.d(E,{N:()=>B});var e=i(7448),_=i(5e3),p=i(520),v=i(1228);let B=(()=>{class m{constructor(l,g){this.http=l,this.authService=g,this.header={headers:{"X-ORG-ID":this.authService.getOrgId()}}}getSpecificRoleTemplateList(l){return this.http.get(`${e.k.backend.host}/role/role-template/specific?bg=`+l,{headers:{"X-ORG-ID":this.authService.getOrgId()}})}getPublicRoleTemplateList(){return this.http.get(`${e.k.backend.host}/role/role-template/public`,{headers:{"X-ORG-ID":this.authService.getOrgId()}})}getRoleTemplateList(){return this.http.get(`${e.k.backend.host}/role/role-template`,this.header)}getRoleList(){return this.http.get(`${e.k.backend.host}/role/role/`,this.header)}getRoleListByID(l){return this.http.get(`${e.k.backend.host}/role/template-based-role/restricted-roles/`,{headers:{"X-ORG-ID":l}})}getRoleListByIDUnRestricted(l){return this.http.get(`${e.k.backend.host}/role/template-based-role/unrestricted-roles/`,{headers:{"X-ORG-ID":l}})}getRoleTemplateById(l,g){return this.http.get(`${e.k.backend.host}/role/role-template/`+g,{headers:{"X-ORG-ID":l}})}saveRoleFromRoleTemplate(l,g,C,L){return L||(L="intelliveer"),console.log(L),this.http.post(`${e.k.backend.host}/role/template-based-role/`+C+"?bg="+g,l,{headers:{"X-ORG-ID":L}})}updateRoleFromRoleTemplate(l,g,C){return C||(C="intelliveer"),console.log(C),this.http.put(`${e.k.backend.host}/role/template-based-role/`+g,l,{headers:{"X-ORG-ID":C}})}saveRoleFromRoleScratch(l){return this.http.post(`${e.k.backend.host}/role/role/`,l,this.header)}updateRoleFromRoleScratch(l,g){return this.http.put(`${e.k.backend.host}/role/role/`+g,l,this.header)}deleteRole(l,g){return g||(g="intelliveer"),this.http.delete(`${e.k.backend.host}/role/role/`+l,{headers:{"X-ORG-ID":g}})}getRoleById(l){return this.http.get(`${e.k.backend.host}/role/role/`+l,this.header)}getRoleByIdBgId(l,g){return this.http.get(`${e.k.backend.host}/role/role/`+l,{headers:{"X-ORG-ID":g}})}getLegelEntityList(){return this.http.get(`${e.k.backend.host}/bg/legal-entity`,this.header)}getLocationList(){return this.http.get(`${e.k.backend.host}/bg/location`,this.header)}getPracticeList(){return this.http.get(`${e.k.backend.host}/bg/practice`,this.header)}getPermissionList(){return this.http.get(`${e.k.backend.host}/role/role-template/permissions/meta`,this.header)}}return m.\u0275fac=function(l){return new(l||m)(_.LFG(p.eN),_.LFG(v.e))},m.\u0275prov=_.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);