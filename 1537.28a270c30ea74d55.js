"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[1537],{1537:(b,v,d)=>{d.r(v),d.d(v,{AddUserModule:()=>O});var l=d(9808),p=d(4996),a=d(2382),e=d(5e3),_=d(9709),m=d(9196),T=d(1228),r=d(4001),u=d(7802),g=d(4376),R=d(1988);function E(n,c){if(1&n&&(e.TgZ(0,"li",25),e._uU(1),e.qZA()),2&n){const t=c.$implicit;e.Q6J("routerLink",t.url),e.xp6(1),e.hij(" ",t.title," ")}}function A(n,c){if(1&n&&(e.TgZ(0,"ng-option",26),e._uU(1),e.qZA()),2&n){const t=c.$implicit;e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.name)}}const C=[{path:"",component:(()=>{class n{constructor(t,o,i,h,s,D,L){this.router=t,this.fb=o,this.userService=i,this.globalRoutes=h,this.authService=s,this.roleService=D,this.businessGroupDropdownService=L,this.formData=void 0,this.urlManageUser="",this.userEmail="",this.menuItems=[],this.user={creds:{email:"",password:""},profile:{firstName:"",lastName:"",email:""},roles:[],userTimeZone:""},this.roles=[],this.roleRRT=!1,this.roleRRTEdit=!1,this.roleRRTAdd=!1,this.roleRRTDelete=!1,this.roleURRT=!1,this.roleURRTEdit=!1,this.roleURRTAdd=!1,this.roleURRTDelete=!1,this.roleList=[],this.businessGroupDropdownSupscription=this.businessGroupDropdownService.businessGroup().subscribe(f=>{f&&(this.selectedBusinessGroup=f,this.getOrgBgId())}),this.urlManageUser=this.globalRoutes.getSettingsUserManageUrl(),this.menuItems.push(this.globalRoutes.getSettingsUserManageRoutes()[0].child[0])}ngOnInit(){this.initForm(this.formData)}getOrgBgId(){var t,o;let i=localStorage.getItem("selected_business_group");console.log(i);let h=this.authService.getOrgId(),s=localStorage.getItem("permissionSet");s=JSON.parse(s),(null==s?void 0:s.__ISSU__)?"intelliveer"==i||null==i?this.getRolesList("intelliveer"):this.getRoleListByBgId(null===(t=this.selectedBusinessGroup)||void 0===t?void 0:t.bgId):(null==s?void 0:s.isBGAdmin)?this.getRoleListByBgAdminId(null===(o=this.selectedBusinessGroup)||void 0===o?void 0:o.bgId):(("intelliveer"==i||null==i)&&(i=h),this.getRoleListByBgId(i))}getRolesList(t){console.log(t),this.userService.getRoles(t).subscribe(o=>{this.roles=o,console.log(this.roles)})}initForm(t){this.Form=this.fb.group({firstName:[(null==(t=t||{})?void 0:t.firstName)||"",a.kI.required],lastName:[(null==t?void 0:t.lastName)||"",a.kI.required],userEmail:[(null==t?void 0:t.userEmail)||"",a.kI.required],password:[(null==t?void 0:t.password)||"",a.kI.required],userRoles:[(null==t?void 0:t.userRoles)||"",a.kI.required],userTimeZone:[(null==t?void 0:t.userTimeZone)||"",a.kI.required]})}ngOnDestroy(){this.businessGroupDropdownSupscription.unsubscribe()}getRoleListByBgId(t){this.checkPermissionRRTOrURRT(),console.log(t),this.roleService.getRoleListByID(t).subscribe(o=>{console.log("list",o),this.roleRRT&&!this.roleURRT?this.roles=o:this.roleRRT&&this.roleURRT?this.roleService.getRoleListByIDUnRestricted(t).subscribe(i=>{this.roles=[...o,...i]}):!this.roleRRT&&this.roleURRT&&this.roleService.getRoleListByIDUnRestricted(t).subscribe(i=>{this.roles=i}),console.log(this.roles)})}getRoleListByBgAdminId(t){this.roleService.getRoleListByID(t).subscribe(o=>{console.log("list",o),this.roleService.getRoleListByIDUnRestricted(t).subscribe(i=>{this.roles=[...o,...i]})})}save(t){var o;this.user.userTimeZone=null===(o=this.Form.value.userTimeZone)||void 0===o?void 0:o.nameValue,this.user.creds.email=this.userEmail,this.user.profile.email=this.userEmail,this.selectedBusinessGroup&&this.userService.saveUsers(this.selectedBusinessGroup.bgId,this.user).subscribe({next:i=>{this.router.navigate(["/dashboard/settings/user-management/manage-user"])},error:()=>{}})}checkPermissionRRTOrURRT(){var t,o;let i=localStorage.getItem("permissionSet");i=JSON.parse(i),console.log(i.roles[0]),null===(o=null===(t=null==i?void 0:i.roles[0])||void 0===t?void 0:t.permissions[0])||void 0===o||o.sections.forEach(h=>{console.log(h),"templateBasedRestrictedRoles"==h.section?h.permissions.forEach(s=>{switch(s.name){case"CAN_CREATE_TEMPLATE_BASED_RESTRICTED_ROLE":this.roleURRTAdd=s.enabled;break;case"CAN_RETRIEVE_TEMPLATE_BASED_RESTRICTED_ROLE":this.roleURRT=s.enabled;break;case"CAN_EDIT_TEMPLATE_BASED_RESTRICTED_ROLE":this.roleURRTEdit=s.enabled;break;case"CAN_DELETE_TEMPLATE_BASED_RESTRICTED_ROLE":this.roleURRTDelete=s.enabled}}):"templateBasedUnRestrictedRoles"==h.section&&h.permissions.forEach(s=>{switch(s.name){case"CAN_CREATE_TEMPLATE_BASED_UNRESTRICTED_ROLE":this.roleRRTAdd=s.enabled;break;case"CAN_RETRIEVE_TEMPLATE_BASED_UNRESTRICTED_ROLE":this.roleRRT=s.enabled;break;case"CAN_EDIT_TEMPLATE_BASED_UNRESTRICTED_ROLE":this.roleRRTEdit=s.enabled;break;case"CAN_DELETE_TEMPLATE_BASED_UNRESTRICTED_ROLE":this.roleRRTDelete=s.enabled}}),console.log(this.roleRRT,this.roleRRTAdd,this.roleRRTDelete,this.roleRRTEdit)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.F0),e.Y36(a.qu),e.Y36(_.K),e.Y36(m.o),e.Y36(T.e),e.Y36(r.N),e.Y36(u.Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-user"]],inputs:{formData:"formData"},decls:55,vars:12,consts:[[1,"row"],[1,"col-2"],[1,"settings-row","pointer",3,"routerLink"],[1,"bi","bi-arrow-left-circle",2,"font-size","2rem"],[1,"ul",2,"margin-top","23px"],["class","pointer","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],[1,"col-10","component-view"],[3,"formGroup","submit"],["f","ngForm"],[1,"section"],[1,"heading"],[1,"row","formrow"],[1,"col-3"],[1,"label-input-gap"],["type","text","formControlName","firstName",1,"form-control",3,"ngModel","ngModelChange"],["type","text","formControlName","lastName",1,"form-control",3,"ngModel","ngModelChange"],["type","text","formControlName","userEmail","email","true",1,"form-control",3,"ngModel","ngModelChange"],["type","password","formControlName","password",1,"form-control","password",3,"ngModel","ngModelChange"],["placeholder","Role name","formControlName","userRoles",2,"border","none",3,"multiple","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Type"],[1,"col-6"],[3,"formControlName"],[1,"col-3",2,"margin-top","4px"],["type","button",1,"btn","btn-dark","btn-dark-custom",3,"disabled","click"],["routerLinkActive","active",1,"pointer",3,"routerLink"],[3,"value"]],template:function(t,o){if(1&t){const i=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"i",3),e.TgZ(4,"p"),e._uU(5,"Manage User"),e.qZA()(),e.TgZ(6,"ul",4),e.YNc(7,E,2,2,"li",5),e.qZA()(),e.TgZ(8,"div",6)(9,"form",7,8),e.NdJ("submit",function(){e.CHM(i);const s=e.MAs(10);return o.save(s.value)}),e.TgZ(11,"div",9)(12,"h6",10),e._uU(13,"Create User"),e.qZA(),e.TgZ(14,"div",11)(15,"div",12)(16,"label",13),e._uU(17,"First Name"),e.qZA(),e.TgZ(18,"input",14),e.NdJ("ngModelChange",function(s){return o.user.profile.firstName=s}),e.qZA()(),e.TgZ(19,"div",12)(20,"label",13),e._uU(21,"Last Name"),e.qZA(),e.TgZ(22,"input",15),e.NdJ("ngModelChange",function(s){return o.user.profile.lastName=s}),e.qZA()()(),e.TgZ(23,"div",11)(24,"div",12)(25,"label",13),e._uU(26,"Email"),e.qZA(),e.TgZ(27,"input",16),e.NdJ("ngModelChange",function(s){return o.userEmail=s}),e.qZA()(),e.TgZ(28,"div",12)(29,"label",13),e._uU(30,"Password"),e.qZA(),e.TgZ(31,"input",17),e.NdJ("ngModelChange",function(s){return o.user.creds.password=s}),e.qZA()()(),e.TgZ(32,"div",11)(33,"div",12)(34,"label",13),e._uU(35,"Roles"),e.qZA(),e.TgZ(36,"ng-select",18),e.NdJ("ngModelChange",function(s){return o.user.roles=s}),e.YNc(37,A,2,2,"ng-option",19),e.qZA()(),e.TgZ(38,"div",12)(39,"label",13),e._uU(40,"Type"),e.qZA(),e.TgZ(41,"ng-select",20)(42,"ng-option"),e._uU(43,"General"),e.qZA(),e.TgZ(44,"ng-option"),e._uU(45,"Provider"),e.qZA()()()(),e.TgZ(46,"div",11)(47,"div",21)(48,"label",13),e._uU(49,"Time Zone"),e.qZA(),e._UZ(50,"ng-moment-timezone-picker",22),e.qZA()(),e.TgZ(51,"div",11)(52,"div",23)(53,"button",24),e.NdJ("click",function(){e.CHM(i);const s=e.MAs(10);return o.save(s.value)}),e._uU(54,"Create"),e.qZA()()()()()()()}2&t&&(e.xp6(2),e.Q6J("routerLink",o.urlManageUser),e.xp6(5),e.Q6J("ngForOf",o.menuItems),e.xp6(2),e.Q6J("formGroup",o.Form),e.xp6(9),e.Q6J("ngModel",o.user.profile.firstName),e.xp6(4),e.Q6J("ngModel",o.user.profile.lastName),e.xp6(5),e.Q6J("ngModel",o.userEmail),e.xp6(4),e.Q6J("ngModel",o.user.creds.password),e.xp6(5),e.Q6J("multiple",!0)("ngModel",o.user.roles),e.xp6(1),e.Q6J("ngForOf",o.roles),e.xp6(13),e.Q6J("formControlName","userTimeZone"),e.xp6(3),e.Q6J("disabled",null==o.Form?null:o.Form.invalid))},directives:[p.rH,l.sg,p.Od,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,a.on,g.w9,g.jq,R.L2],styles:[".add_btn[_ngcontent-%COMP%]{border:none;background:transparent;width:34px}.add_btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:36px}.search_box[_ngcontent-%COMP%]{border:1px solid #dbdcdd;border-radius:6px}tr[_ngcontent-%COMP%]{line-height:3}.table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){border-top:1px solid currentColor}.more_btn[_ngcontent-%COMP%]{font-size:16px;font-weight:700;background-color:transparent;border:none}table.table[_ngcontent-%COMP%]{table-layout:fixed}table.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;text-align:start}table.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1){width:min-content}ul[_ngcontent-%COMP%]{font-size:13px;font-weight:700}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{line-height:3.2}.password[_ngcontent-%COMP%], .password[_ngcontent-%COMP%]:focus{border:1px solid #dddedf;height:36px}"]}),n})()}];let M=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[p.Bz.forChild(C)],p.Bz]}),n})();var U=d(9759);let O=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[l.ez,M,U.IJ,g.A0,a.u5,a.UX,R.Gg]]}),n})()},4001:(b,v,d)=>{d.d(v,{N:()=>_});var l=d(7448),p=d(5e3),a=d(520),e=d(1228);let _=(()=>{class m{constructor(r,u){this.http=r,this.authService=u,this.header={headers:{"X-ORG-ID":this.authService.getOrgId()}}}getSpecificRoleTemplateList(r){return this.http.get(`${l.k.backend.host}/role/role-template/specific?bg=`+r,{headers:{"X-ORG-ID":this.authService.getOrgId()}})}getPublicRoleTemplateList(){return this.http.get(`${l.k.backend.host}/role/role-template/public`,{headers:{"X-ORG-ID":this.authService.getOrgId()}})}getRoleTemplateList(){return this.http.get(`${l.k.backend.host}/role/role-template`,this.header)}getRoleList(){return this.http.get(`${l.k.backend.host}/role/role/`,this.header)}getRoleListByID(r){return this.http.get(`${l.k.backend.host}/role/template-based-role/restricted-roles/`,{headers:{"X-ORG-ID":r}})}getRoleListByIDUnRestricted(r){return this.http.get(`${l.k.backend.host}/role/template-based-role/unrestricted-roles/`,{headers:{"X-ORG-ID":r}})}getRoleTemplateById(r,u){return this.http.get(`${l.k.backend.host}/role/role-template/`+u,{headers:{"X-ORG-ID":r}})}saveRoleFromRoleTemplate(r,u,g,R){return R||(R="intelliveer"),console.log(R),this.http.post(`${l.k.backend.host}/role/template-based-role/`+g+"?bg="+u,r,{headers:{"X-ORG-ID":R}})}updateRoleFromRoleTemplate(r,u,g){return g||(g="intelliveer"),console.log(g),this.http.put(`${l.k.backend.host}/role/template-based-role/`+u,r,{headers:{"X-ORG-ID":g}})}saveRoleFromRoleScratch(r){return this.http.post(`${l.k.backend.host}/role/role/`,r,this.header)}updateRoleFromRoleScratch(r,u){return this.http.put(`${l.k.backend.host}/role/role/`+u,r,this.header)}deleteRole(r,u){return u||(u="intelliveer"),this.http.delete(`${l.k.backend.host}/role/role/`+r,{headers:{"X-ORG-ID":u}})}getRoleById(r){return this.http.get(`${l.k.backend.host}/role/role/`+r,this.header)}getRoleByIdBgId(r,u){return this.http.get(`${l.k.backend.host}/role/role/`+r,{headers:{"X-ORG-ID":u}})}getLegelEntityList(){return this.http.get(`${l.k.backend.host}/bg/legal-entity`,this.header)}getLocationList(){return this.http.get(`${l.k.backend.host}/bg/location`,this.header)}getPracticeList(){return this.http.get(`${l.k.backend.host}/bg/practice`,this.header)}getPermissionList(){return this.http.get(`${l.k.backend.host}/role/role-template/permissions/meta`,this.header)}}return m.\u0275fac=function(r){return new(r||m)(p.LFG(a.eN),p.LFG(e.e))},m.\u0275prov=p.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);