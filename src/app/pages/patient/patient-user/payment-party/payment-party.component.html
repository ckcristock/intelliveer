<div *ngIf="paymentPartyList?.length == 0" class="section" style="height: 90%">
	<div style="text-align: center; padding-top: 7%">
		<div>
			<h5><b>You havenâ€™t added yet</b></h5>
			<p>
				Click here,
				<img
					src="assets/icons/add.svg"
					width="36"
					height="36"
					*ngIf="!showRelationList"
					(click)="showRelationList = true"
				/>
				<img
					src="assets/icons/add-disabled.png"
					width="36"
					height="36"
					*ngIf="showRelationList"
				/>
				to add Payment Party
			</p>
		</div>
		<div class="mb-3" *ngIf="showRelationList">
			<p>What is the relationship of new Payment Party to patient?</p>
			<div *ngIf="form">
				<form [formGroup]="form">
					<div class="row">
						<div class="col-4"></div>
						<div class="col-6">
							<div *ngIf="form">
								<form [formGroup]="form">
									<select
										formControlName="relationship"
										class="form-select"
										style="width: 64.8%"
										(change)="showList = true"
									>
										<option value="" disabled selected>
											Select Relationship
										</option>
										<option
											aria-placeholder="Select Relationship"
											*ngFor="
												let relationship of relationships
											"
											[ngValue]="relationship.value"
										>
											{{ relationship.value }}
										</option>
									</select>
								</form>
							</div>
						</div>
						<div class="col-3"></div>
					</div>
				</form>
			</div>
		</div>
		<div class="mb-3" *ngIf="showList">
			<p>Please search first If not found, create a new one</p>
			<div class="row gy-2">
				<div class="col-4"></div>
				<div class="col-6" style="text-align: center">
					<div class="search" #searchDivRef>
						<div class="search-results" *ngIf="searchFocus">
							<ul *ngIf="paymentPartySearchLst?.length != 0">
								<li
									*ngFor="let result of paymentPartySearchLst"
								>
									<button
										class="d-flex justify-content-between"
										(click)="
											handleSearchResultsClick(result)
										"
									>
										<span> {{ result.profile.firstName }}</span>
									</button>
								</li>
							</ul>
							<div
								class="padding justify-content-between"
								*ngIf="paymentPartySearchLst?.length == 0"
							>
								<p>No matches found</p>
								<p>Would you like to create a new one?</p>
							</div>
							<div class="d-flex gap-3 ps-4 align-items-center">
								<div class="btn-group me-3">
									<button
										(click)="goToAddPaymentParty()"
										type="button"
										class="btn button-create-new"
									>
										Create new Payment Party
									</button>
								</div>
							</div>
						</div>
						<div class="input-group justify-content-between">
							<span
								class="input-group-text bg-transparent"
								id="basic-addon1"
								><i class="bi bi-search"></i
							></span>
							<input
								type="text"
								class="form-control"
								placeholder="Type Name"
								[(ngModel)]="searchWord"
								(keyup)="fetchSearch($event)"
								aria-describedby="basic-addon1"
								(focus)="searchFocus = true"
								style="border-left-style: none"
							/>
						</div>
					</div>
				</div>
				<div class="col-3"></div>
			</div>
		</div>
		<div *ngIf="showSelectedPatient">
			<button class="btn btn-dark" (click)="addAsPaymentParty()">
				Add as a Payment Party
			</button>
		</div>
	</div>
</div>

<div *ngIf="paymentPartyList?.length != 0">
	<app-nav-bar-pills
		[menuItems]="menuItems"
		[activeClass]="''"
		[cancelBtn]="false"
		[saveBtn]="false"
		[addBtn]="true"
		(onAdd)="onAdd()"
	></app-nav-bar-pills>
	<div
		class="container"
		*ngFor="let paymentParty of paymentPartyList; let i = index"
	>
		<div class="section">
			<div class="row">
				<div
					class="col-2"
					routerLink="/dashboard/patient/patient-user/payment-party/edit/{{
						paymentParty._id
					}}"
				>
					<div class="letter">
						<p>{{ paymentParty.profile.firstName.charAt(0) }}</p>
						<div id="orange">
							<span>{{ 'PRIMARY' }}</span>
						</div>
					</div>
				</div>
				<div
					class="col-3"
					routerLink="/dashboard/patient/patient-user/payment-party/edit/{{
						paymentParty._id
					}}"
				>
					<p>
						{{ paymentParty.profile.firstName }}
						{{ paymentParty.profile.lastName }}
					</p>
					<p>{{ paymentParty.practiceName }}</p>
					<p>{{ paymentParty.specialty }}</p>
				</div>
				<div
					class="col-6"
					routerLink="/dashboard/patient/patient-user/payment-party/edit/{{
						paymentParty._id
					}}"
				>
					<p>
						Prefered mail method:
						<span>{{ paymentParty.contact.email }}</span>
					</p>
					<p>
						Primary Phone number:
						<span>{{
							paymentParty.contact.primaryPhone.number
						}}</span>
					</p>
					<p>
						Email: <span>{{ paymentParty.contact.email }}</span>
					</p>
					<p>
						No. of mutual patient:
						<span>{{ paymentParty.mutualPatient }}</span>
					</p>
				</div>
				<div class="col-1">
					<div ngbDropdown class="d-inline-block">
						<i
							class="bi bi-three-dots-vertical"
							id="dropdownBasic"
							ngbDropdownToggle
						></i>
						<ul ngbDropdownMenu aria-labelledby="dropdownBasic">
							<li
								ngbDropdownItem
								routerLink="/dashboard/patient/patient-user/payment-party/edit/{{
									paymentParty._id
								}}"
							>
								Edit
							</li>
							<li ngbDropdownItem>
								{{
									paymentParty.isDisabled
										? 'Reactivate'
										: 'Deactivate'
								}}
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
