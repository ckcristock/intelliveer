<div class="container">
	<app-nav-bar-pills
		[cancelBtn]="true"
		[saveBtn]="true"
		[disableSaveBtn]="false"
		(onCancel)="cancel()"
		(onSave)="save($event)"
	></app-nav-bar-pills>
	<div class="row">
		<div class="col-6">
			<div class="section">
				<h6
					class="heading"
					style="padding-left: 2rem; padding-right: 2rem"
				>
					Option {{ '1' }}
				</h6>
				<hr />
				<div
					class="scroll"
					style="padding-left: 2rem; padding-right: 2rem"
				>
					<table class="table">
						<tbody>
							<tr>
								<td style="font-weight: bold">Timing</td>
								<td>
									<p>{{ 'Observation: 3 months' }}</p>
								</td>
							</tr>
							<tr>
								<td style="font-weight: bold">
									Treament Phase
								</td>
								<td>
									<p>
										{{ 'Comprehenssive' }}
									</p>
								</td>
							</tr>
							<tr>
								<td style="font-weight: bold">Treament Type</td>
								<td>
									<p>
										{{ 'Braces' }}
									</p>
								</td>
							</tr>
							<tr>
								<td style="font-weight: bold">Treament Time</td>
								<td>
									<p>
										{{ '30-36 Months' }}
									</p>
								</td>
							</tr>
							<tr>
								<td style="font-weight: bold">Prerequisites</td>
								<td>
									<p
										*ngFor="
											let prerequisties of prerequisitesArray
										"
									>
										{{ prerequisties }}
									</p>
								</td>
							</tr>
							<tr>
								<td style="font-weight: bold">
									Treatment Steps
								</td>
								<td>
									<p
										*ngFor="
											let treatmentStep of treatmentStepArray
										"
									>
										{{ treatmentStep }}
									</p>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div class="col-6">
			<div class="section">
				<h6
					class="heading"
					style="padding-left: 2rem; padding-right: 2rem"
				>
					Option {{ '1' }}
				</h6>
				<hr />
				<div style="padding-left: 2rem; padding-right: 2rem">
					<div class="row mb-3"><b>Fee Breakdown</b></div>
					<div class="row mb-3">
						<div class="col">Treatment Charges</div>
						<div class="col" [align]="'end'">$5,650.00</div>
					</div>
					<hr />
					<div class="row mb-3">
						<div class="col">Discounts</div>
						<div class="col" [align]="'end'" style="color: #2ea74f">
							($582.50)
						</div>
					</div>
					<hr />
					<div class="row mb-3">
						<div class="col">Final cost to do treatment</div>
						<div
							class="col"
							[align]="'end'"
							style="font-weight: 600"
						>
							$2,567.50
						</div>
					</div>
					<div class="row mb-3">
						<div class="col">Estimated Insurance Coverage</div>
						<div class="col" [align]="'end'">$2,500.00</div>
					</div>
					<div class="row mb-1">
						<div
							class="col"
							style="
								color: #8a8c8e;
								vertical-align: middle;
								display: flex;
								margin: auto;
							"
						>
							Patient's Responsibility
						</div>
						<div
							class="col"
							[align]="'end'"
							style="font-weight: 600; font-size: x-large"
						>
							$2,567.50
						</div>
					</div>
					<hr />
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-3" *ngFor="let item of paymentParty; let i = index">
			<div class="payment-party">Payment Party {{ item.count }}</div>
			<input
				type="number"
				class="form-control my-2"
				name="paymentPartyPercent{{ i }}"
				min="1"
				max="100"
				(input)="customPaymentParty($event, i)"
				[(ngModel)]="paymentPartyPercent[i]"
				*ngIf="i != 2"
			/>
			<input
				type="number"
				class="form-control my-2"
				name="paymentPartyTotal{{ i }}"
				min="1"
				(input)="paymentPartyPrice($event, i)"
				[(ngModel)]="paymentPartyTotal[i]"
				*ngIf="i != 2"
			/>
			<input
				type="number"
				class="form-control my-2"
				name="paymentPartyPercent{{ i }}"
				min="1"
				[(ngModel)]="paymentPartyPercent[i]"
				readonly
				*ngIf="i == 2"
			/>
			<input
				type="number"
				class="form-control my-2"
				name="paymentPartyTotal{{ i }}"
				min="1"
				[(ngModel)]="paymentPartyTotal[i]"
				readonly
				*ngIf="i == 2"
			/>
		</div>
		<div class="col-2" *ngIf="paymentParty.length < 3">
			<span (click)="addMorePaymentParty()">
				<img
					src="assets/icons/add.svg"
					width="20"
					height="20"
				/>&nbsp;Add another
			</span>
		</div>
	</div>
	<nav ngbNav #nav="ngbNav" class="nav-tabs">
		<ng-container ngbNavItem>
			<a ngbNavLink>Payment Party 1</a>
			<ng-template ngbNavContent>
				<div class="row pt-4">
					<app-payment-party1
						[compareAllOptionArray]="compareAllOptionArray"
					></app-payment-party1>
				</div>
			</ng-template>
		</ng-container>
		<ng-container ngbNavItem>
			<a ngbNavLink>Payment Party 2</a>
			<ng-template ngbNavContent>
				<p>
					Exercitation +1 labore velit, blog sartorial PBR leggings
					next level wes anderson artisan four loko farm-to-table
					craft beer twee. Qui photo booth letterpress, commodo enim
					craft beer mlkshk aliquip jean shorts ullamco ad vinyl
					cillum PBR. Homo nostrud organic, assumenda labore aesthetic
					magna delectus mollit. Keytar helvetica VHS salvia yr, vero
					magna velit sapiente labore stumptown. Vegan fanny pack odio
					cillum wes anderson 8-bit, sustainable jean shorts beard ut
					DIY ethical culpa terry richardson biodiesel. Art party
					scenester stumptown, tumblr butcher vero sint qui sapiente
					accusamus tattooed echo park.
				</p>
			</ng-template>
		</ng-container>
	</nav>
	<div [ngbNavOutlet]="nav" class="mt-2"></div>
</div>

<ng-template #content let-modal>
	<div class="modal-header">
		<h4 class="modal-title"></h4>
		<button
			type="button"
			class="btn-close"
			aria-label="Close"
			(click)="modal.dismiss('Cross click')"
		></button>
	</div>
	<div class="modal-body">
		<!-- <div class="row">
			<div class="col">
				<p>Minimum Total Down Payment</p>
				<div class="input-group mb-3">
					<input type="text" class="form-control" name="downPayment1" (input)="customCalculate($event)" [(ngModel)]="downPayment1"/>
				</div>
			</div>
		</div>
		<div class="row" *ngIf="isDownPayment2">
			<div class="col">
				<p>Minimum 1st Down Payment Amount on split</p>
				<div class="input-group mb-3">
					<input type="text" class="form-control" name="minDownPayment1" [(ngModel)]="minDownPayment1"/>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col">
				<p>Maximum No. of Payments</p>
				<p>{{totalMonth}}</p>
			</div>
		</div> -->
		<div class="row">
			<div class="col">
				<p>Down Payment</p>
				<div class="row">
					<div class="col-md-6">
						<label for="default">Default</label>
						<input
							type="text"
							class="form-control"
							name="downPayment1"
						/>
					</div>
					<div class="col-md-6">
						<label for="default">Minimum</label>
						<input
							type="text"
							class="form-control"
							name="downPayment1"
						/>
					</div>
				</div>
			</div>
		</div>
		<div class="row mt-3">
			<div class="col">
				<p>Split Down Payment</p>
				<div class="input-group mb-3">
					<input
						type="text"
						class="form-control"
						name="minDownPayment1"
					/>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col">
				<p>Minimum Payment Amount</p>
				<div class="input-group mb-3">
					<input
						type="text"
						class="form-control"
						name="minPaymentAmountEmi"
						(input)="minPyamentAmount($event)"
						[(ngModel)]="minPaymentAmountEmi"
					/>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col">
				<p>No. of Months</p>
				<div class="row">
					<div class="col-md-4 text-end pt-2">
						<p class="mt-4">Tx. time -</p>
					</div>
					<div class="col-md-4">
						<label for="default">Default</label>
						<input
							type="text"
							class="form-control"
							name="downPayment1"
						/>
					</div>
					<div class="col-md-4">
						<label for="default">Minimum</label>
						<input
							type="text"
							class="form-control"
							name="downPayment1"
						/>
					</div>
				</div>
			</div>
		</div>
		<div class="row mt-3">
			<div class="col">
				<p>Maximum No. of Payments</p>
				<p>{{ totalMonth }}</p>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<button
			type="button"
			class="btn btn-dark"
			(click)="modal.close('Close click')"
		>
			Save
		</button>
	</div>
</ng-template>
<ng-template #calendar let-modal>
	<div class="modal-header">
		<h4 class="modal-title" id="modal-basic-title">Payment Date</h4>
		<button
			type="button"
			class="btn-close"
			aria-label="Close"
			(click)="modal.dismiss('Cross click')"
		></button>
	</div>
	<div class="modal-body">
		<div class="row" *ngIf="!tabDate || !tabTwoDate || !tabThreeDate">
			<!-- Tabs navs -->
			<ul class="nav nav-tabs mb-3" id="ex1" role="tablist">
				<li class="nav-item" role="presentation">
					<a
						class="nav-link"
						id="ex1-tab-1"
						data-mdb-toggle="tab"
						role="tab"
						aria-controls="ex1-tabs-1"
						aria-selected="true"
						[ngClass]="[tab ? 'active' : '']"
						>Down Payment</a
					>
				</li>
				<li class="nav-item" role="presentation">
					<a
						class="nav-link"
						id="ex1-tab-2"
						data-mdb-toggle="tab"
						role="tab"
						aria-controls="ex1-tabs-2"
						aria-selected="false"
						[ngClass]="[tabTwo ? 'active' : '']"
						>Down Payment 2</a
					>
				</li>
				<li class="nav-item" role="presentation">
					<a
						class="nav-link"
						id="ex1-tab-3"
						data-mdb-toggle="tab"
						role="tab"
						aria-controls="ex1-tabs-3"
						aria-selected="false"
						[ngClass]="[tabThree ? 'active' : '']"
						>Installment</a
					>
				</li>
			</ul>
			<!-- Tabs navs -->
			<!-- Tabs content -->
			<div class="tab-content" id="ex1-content">
				<div
					class="tab-pane fade show active"
					id="ex1-tabs-1"
					role="tabpanel"
					aria-labelledby="ex1-tab-1"
					*ngIf="tab"
				>
					<ngb-datepicker
						#dp
						[(ngModel)]="model"
						(click)="getDate('tab', model)"
						(navigate)="date = $event.next"
					></ngb-datepicker>
				</div>
				<div
					class="tab-pane fade show active"
					id="ex1-tabs-2"
					role="tabpanel"
					aria-labelledby="ex1-tab-2"
					*ngIf="tabTwo"
				>
					<ngb-datepicker
						#dp
						[(ngModel)]="modelTwo"
						(click)="getDate('tabTwo', modelTwo)"
						(navigate)="date = $event.next"
					></ngb-datepicker>
				</div>
				<div
					class="tab-pane fade show active"
					id="ex1-tabs-3"
					role="tabpanel"
					aria-labelledby="ex1-tab-3"
					*ngIf="tabThree"
				>
					<ngb-datepicker
						#dp
						[(ngModel)]="modelThree"
						(click)="getDate('tabThree', modelThree)"
						(navigate)="date = $event.next"
					></ngb-datepicker>
					<ng-select
						placeholder="Select Type"
						(change)="checkMonthlyValue($event)"
					>
						<ng-option value="monthly">Monthly</ng-option>
						<ng-option value="byMonthly">Bi-Monthly</ng-option>
						<ng-option value="weekly">Weekly</ng-option>
					</ng-select>
					<div class="col" *ngIf="isMonthlyStatus">
						<button (click)="showDate('tabThree', modelThree)">
							Save
						</button>
					</div>
				</div>
			</div>
			<!-- Tabs content -->
		</div>
		<div class="row" *ngIf="tabDate && tabTwoDate && tabThreeDate">
			<table class="table">
				<thead>
					<tr>
						<th scope="col"></th>
						<th scope="col">Amount($)</th>
						<th scope="col">Date</th>
						<th scope="col"></th>
					</tr>
				</thead>
				<tbody class="text-center">
					<tr>
						<th>Down Payment 1</th>
						<td>${{ downPayment }}</td>
						<td>{{ tabDate | date: 'MM/d/yyyy' }}</td>
						<td>
							<img
								src="assets/icons/Edit.svg"
								(click)="d.toggle()"
								style="width: 20px"
							/>
							<input
								type="hidden"
								class="form-control"
								placeholder="yyyy-mm-dd"
								name="dp"
								[(ngModel)]="model"
								(dateSelect)="getDate('tab', model)"
								ngbDatepicker
								#d="ngbDatepicker"
							/>
						</td>
					</tr>
					<tr>
						<th>Down Payment 2</th>
						<td>${{ downPayment2 }}</td>
						<td>{{ tabTwoDate | date: 'MM/d/yyyy' }}</td>
						<td>
							<img
								src="assets/icons/Edit.svg"
								(click)="d2.toggle()"
								style="width: 20px"
							/>
							<input
								type="hidden"
								class="form-control"
								placeholder="yyyy-mm-dd"
								name="dp"
								[(ngModel)]="modelTwo"
								(dateSelect)="getDate('tabTwo', modelTwo)"
								ngbDatepicker
								#d2="ngbDatepicker"
							/>
						</td>
					</tr>
				</tbody>
			</table>
			<table class="table">
				<thead>
					<tr>
						<th scope="col">Installemnts({{ monthlyCount }})</th>
						<th scope="col">Amount($)</th>
						<th scope="col">Date(Monthly)</th>
						<th scope="col"></th>
					</tr>
				</thead>
				<tbody class="text-center">
					<tr *ngFor="let item of monthDateObj; let i = index">
						<th>Payment {{ i + 1 }}</th>
						<td>${{ monthlyEmi | number: '1.2-2' }}</td>
						<td>{{ item.date | date: 'MM/d/yyyy' }}</td>
						<!-- <td *ngIf="i % 2 !=0">{{monthDateObj[i].date  | date: 'dd MMMM YYYY'}}</td> -->
						<td *ngIf="i == 0">
							<img
								src="assets/icons/Edit.svg"
								(click)="d3.toggle()"
								style="width: 20px"
							/>
							<input
								type="hidden"
								class="form-control"
								placeholder="yyyy-mm-dd"
								name="dp"
								[(ngModel)]="modelThree"
								(dateSelect)="getDate('tabThree', modelThree)"
								ngbDatepicker
								#d3="ngbDatepicker"
							/>
						</td>
						<td *ngIf="i != 0"></td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</ng-template>
